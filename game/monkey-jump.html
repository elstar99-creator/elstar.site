<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Monkey Jump ‚Äî Game Elstar</title>
  <style>
    :root{--bg:#e0f7fa;--ground:#6b4f2b;--tree:#2e7d32}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial}
    #gameWrap{
      display:flex;align-items:center;justify-content:center;
      height:100vh;
      background:linear-gradient(#cdeff6, var(--bg));
      position:relative;
    }
    canvas{
      background:transparent;border-radius:12px;
      box-shadow:0 8px 30px rgba(0,0,0,0.15)
    }
    .ui{
      position:absolute;left:18px;top:18px;color:#084;font-weight:600
    }
    .hint{
      position:absolute;right:18px;top:18px;color:#055;opacity:0.85
    }
    #startBtn{
      position:absolute;
      padding:14px 28px;
      background:#00a884;
      border:0;
      border-radius:12px;
      color:white;
      font-weight:600;
      font-size:20px;
      cursor:pointer;
      box-shadow:0 6px 20px rgba(0,0,0,0.25);
      display:block;
      z-index:9;
    }
  </style>
</head>
<body>
  <div id="gameWrap">
    <canvas id="c" width="900" height="320"></canvas>

    <div class="ui">Score: <span id="score">0</span></div>
    <div class="hint">Tap / Space to jump ‚Ä¢ R restart</div>

    <button id="startBtn">START GAME üêí</button>
  </div>

<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
const W = canvas.width, H = canvas.height;

let gravity = 0.9;
let gameSpeed = 4; // ‚ùó versi pelan
let score = 0;
let highScore = localStorage.getItem('monkey-high') || 0;
let running = false; // ‚ùó default berhenti dulu (ada tombol start)

const groundY = H - 60;

// üêí Monkey player (dibesarkan)
const player = {
  x: 80,
  y: groundY - 90,
  w: 70,      // ‚ùó monyet diperbesar
  h: 90,      // ‚ùó monyet diperbesar
  vy: 0,
  jumpStrength: -17,
  grounded: true,
  draw() {
    ctx.save();
    ctx.translate(this.x, this.y);

    // body
    ctx.fillStyle = '#a0522d';
    roundRect(ctx, 10, 30, 50, 60, 10, true, false);

    // head
    ctx.beginPath(); ctx.arc(35,20,22,0,Math.PI*2); ctx.fill();

    // face patch
    ctx.fillStyle = '#f3d6b6';
    ctx.beginPath(); ctx.arc(35,22,15,0,Math.PI*2); ctx.fill();

    // eyes
    ctx.fillStyle = '#000';
    ctx.fillRect(27,15,5,5);
    ctx.fillRect(40,15,5,5);

    // smile
    ctx.beginPath();
    ctx.arc(35,30,7,0,Math.PI);
    ctx.stroke();

    // tail
    ctx.strokeStyle='#a0522d'; ctx.lineWidth=5;
    ctx.beginPath(); ctx.moveTo(0,40);
    ctx.quadraticCurveTo(-25,10,0,5);
    ctx.stroke();

    ctx.restore();
  }
};

// üå¥ Obstacles (POHON RENDAH)
let obstacles = [];
function spawnObstacle(){
  const h = 40 + Math.random()*20; // ‚ùó jauh lebih rendah
  const obs = {
    x: W + 40,
    w: 40,
    h: h,
    passed: false,
    draw(){
      ctx.fillStyle = '#6b4f2b';
      roundRect(ctx, this.x, groundY - this.h, this.w, this.h, 8, true, false);

      ctx.fillStyle = '#2e7d32';
      ctx.beginPath();
      ctx.ellipse(this.x+20, groundY-this.h-6, 32, 12, 0, 0, Math.PI*2);
      ctx.fill();

      ctx.fillStyle = '#ffd54f';
      ctx.beginPath(); ctx.arc(this.x+15, groundY-this.h-6, 5,0,Math.PI*2); ctx.fill();
    },
    update(){ this.x -= gameSpeed; }
  };
  obstacles.push(obs);
}

// Rounded rectangle helper
function roundRect(ctx, x, y, w, h, r, fill, stroke){
  ctx.beginPath();
  ctx.moveTo(x+r,y);
  ctx.arcTo(x+w,y,x+w,y+h,r);
  ctx.arcTo(x+w,y+h,x,y+h,r);
  ctx.arcTo(x,y+h,x,y,r);
  ctx.arcTo(x,y,x+w,y,r);
  ctx.closePath();
  if(fill) ctx.fill();
  if(stroke) ctx.stroke();
}

// JUMP
function jump(){
  if(!running) return;
  if(player.grounded){
    player.vy = player.jumpStrength;
    player.grounded = false;
  }
}

// Input
document.addEventListener('keydown', e=>{
  if(e.code==='Space'){ e.preventDefault(); jump(); }
  if(e.key==='r') reset();
});
canvas.addEventListener('mousedown', jump);
canvas.addEventListener('touchstart', e=>{ e.preventDefault(); jump(); });

// GAME LOOP UPDATE
let spawnTimer = 0;
function update(){
  if(!running) return;

  player.vy += gravity;
  player.y += player.vy;
  if(player.y + player.h >= groundY){
    player.y = groundY - player.h;
    player.vy = 0;
    player.grounded = true;
  }

  obstacles.forEach(o=> o.update());
  if(obstacles.length && obstacles[0].x + obstacles[0].w < -50) obstacles.shift();

  spawnTimer--;
  if(spawnTimer <= 0){
    spawnObstacle();
    spawnTimer = 90 + Math.random()*70; // ‚ùó lebih jarang
  }

  // score
  obstacles.forEach(o=>{
    if(!o.passed && o.x + o.w < player.x){
      o.passed = true;
      score += 10;
      document.getElementById('score').textContent = score;
    }
    if(collide(player, o)){
      running=false;
      endGame();
    }
  });
}

// Collision
function collide(p,o){
  return p.x < o.x+o.w && p.x+p.w > o.x &&
         p.y < groundY && p.y+p.h > groundY-o.h;
}

// DRAW
function draw(){
  ctx.clearRect(0,0,W,H);

  const g = ctx.createLinearGradient(0,0,0,H);
  g.addColorStop(0,'#cdeff6');
  g.addColorStop(1,'#e8f8ff');
  ctx.fillStyle=g; ctx.fillRect(0,0,W,H);

  ctx.fillStyle='#fff59d';
  ctx.beginPath(); ctx.arc(W-80,60,30,0,Math.PI*2); ctx.fill();

  ctx.fillStyle='#7c5a2b'; ctx.fillRect(0, groundY, W, 70);

  obstacles.forEach(o=>o.draw());
  player.draw();

  ctx.fillStyle='#045';
  ctx.font='16px system-ui';
  ctx.fillText("High: "+highScore, 16, 22);
}

function loop(){
  update();
  draw();
  if(running) requestAnimationFrame(loop);
}

// GAME OVER
function endGame(){
  ctx.fillStyle='rgba(0,0,0,0.35)';
  ctx.fillRect(0,0,W,H);

  ctx.fillStyle='#fff';
  ctx.font='28px system-ui';
  ctx.textAlign='center';
  ctx.fillText('Game Over',W/2,H/2-10);
  ctx.font='16px system-ui';
  ctx.fillText('Tap START untuk main lagi',W/2,H/2+18);

  if(score>highScore){
    highScore=score;
    localStorage.setItem('monkey-high',highScore);
  }

  document.getElementById('startBtn').style.display='block';
  document.getElementById('startBtn').textContent='PLAY AGAIN üêí';
}

// RESET
function reset(){
  obstacles=[];
  score=0;
  document.getElementById('score').textContent=0;
  player.y=groundY-player.h;
  player.vy=0;
  running=true;
  spawnTimer=50;
  loop();
}

// START BUTTON
document.getElementById('startBtn').onclick=()=>{
  score=0; obstacles=[];
  player.y=groundY-player.h; player.vy=0;
  document.getElementById('score').textContent=0;
  running=true;
  document.getElementById('startBtn').style.display='none';
  spawnTimer=40;
  loop();
}

// AUTO RESIZE CANVAS (mobile & desktop)
function resizeGame() {
  let baseW = 900;
  let baseH = 320;

  // Jika layar kecil (HP)
  if (window.innerWidth < 700) {
    const scale = window.innerWidth / baseW;

    canvas.style.width = window.innerWidth + "px";
    canvas.style.height = baseH * scale + "px";

    canvas.width = baseW * scale;
    canvas.height = baseH * scale;

    ctx.setTransform(scale, 0, 0, scale, 0, 0);
  } else {
    // Desktop normal
    canvas.style.width = baseW + "px";
    canvas.style.height = baseH + "px";

    canvas.width = baseW;
    canvas.height = baseH;

    ctx.setTransform(1, 0, 0, 1, 0, 0);
  }
}

resizeGame();
window.addEventListener("resize", resizeGame);

draw();
    </script>
</body>
</html>
